---
phase: 10-quality-polish
plan: "02"
type: execute
wave: 1
depends_on: []
files_modified:
  - cotizador-template/cotizador-template.html
autonomous: true
requirements: [QUAL-02]

must_haves:
  truths:
    - "Cocina PDF has a cover page as the first page with company branding, project name, client name, and date"
    - "The existing cocina PDF sections (module index, despiece, hardware summary, extras, technical note) remain intact"
    - "Non-cocina PDFs are completely unaffected"
  artifacts:
    - path: "cotizador-template/cotizador-template.html"
      provides: "Cover page generation in genClientPDF() for cocina projects"
      contains: "COVER PAGE"
  key_links:
    - from: "genClientPDF() cover page block"
      to: "P.type === 'cocina' gate"
      via: "conditional new page insertion before existing content"
      pattern: "P\\.type === 'cocina'"
    - from: "genClientPDF() cover page"
      to: "APP_CONFIG branding (S.logoBase64, br.name)"
      via: "logo and company name on cover"
      pattern: "S\\.logoBase64"
---

<objective>
Add a professional cover page to the cocina client PDF, making it the first page of the document.

Purpose: QUAL-02 requires the cocina PDF to have a cover page, module index, per-module despiece, and material/hardware summaries. Phase 4 already built the module index, despiece, hardware summary, extras list, and technical note sections. The only missing piece is the cover page.
Output: Cocina PDFs now open with a branded cover page before the existing quote page.
</objective>

<execution_context>
@C:/Users/Steven PC/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Steven PC/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-cocina-extras-ui-output/04-03-SUMMARY.md
@CONTEXT.md
@cotizador-template/cotizador-template.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add cocina cover page to genClientPDF()</name>
  <files>cotizador-template/cotizador-template.html</files>
  <action>
In genClientPDF() (starts at line 9509), insert a cocina cover page as the FIRST page of the document, BEFORE the existing "PAGE 1: QUOTE" section. The cover page should only render for cocina projects.

Find the line `// === PAGE 1: QUOTE ===` (around line 9525). BEFORE this line, insert a cocina cover page block:

```javascript
// === COVER PAGE (cocina only) ===
if (P.type === 'cocina') {
    // Full-page dark background
    doc.setFillColor(13, 13, 13); // #0d0d0d matching client PDF dark theme
    doc.rect(0, 0, pw, ph, 'F');

    // Company logo centered at top
    var coverY = 50;
    if (S.logoBase64) {
        try {
            doc.addImage(S.logoBase64, 'PNG', (pw - 60) / 2, coverY, 60, 24);
            coverY += 35;
        } catch (e) { coverY += 10; }
    }

    // Company name
    doc.setFontSize(28);
    doc.setFont('helvetica', 'bold');
    doc.setTextColor(196, 154, 108); // #c49a6c gold accent
    doc.text(br.name.toUpperCase(), pw / 2, coverY, { align: 'center' });
    coverY += 15;

    // Decorative line
    doc.setDrawColor(196, 154, 108);
    doc.setLineWidth(0.5);
    doc.line(pw / 2 - 40, coverY, pw / 2 + 40, coverY);
    coverY += 20;

    // "COTIZACION DE COCINA" title
    doc.setFontSize(22);
    doc.setFont('helvetica', 'bold');
    doc.setTextColor(255, 255, 255);
    doc.text('COTIZACION DE COCINA', pw / 2, coverY, { align: 'center' });
    coverY += 30;

    // Project info block
    doc.setFontSize(13);
    doc.setFont('helvetica', 'normal');
    doc.setTextColor(200, 200, 200);
    var infoLines = [
        'Proyecto: ' + (P.name || 'Sin nombre'),
        'Cliente: ' + (P.client || 'Sin cliente'),
        'Fecha: ' + fmtDatePDF(),
        'Cotizacion: ' + d.quoteNum,
        'Modulos: ' + P.modules.length
    ];
    infoLines.forEach(function(ln) {
        doc.text(ln, pw / 2, coverY, { align: 'center' });
        coverY += 8;
    });

    // Footer with contact info
    doc.setFontSize(9);
    doc.setTextColor(120, 120, 120);
    var contactLine = br.contact || '';
    if (contactLine) {
        doc.text(contactLine, pw / 2, ph - 20, { align: 'center' });
    }

    // Add new page for the actual quote content
    doc.addPage();
    y = margin; // Reset y position for quote page
}
```

Important notes:
- The cover page uses the same dark theme (#0d0d0d background, #c49a6c gold accent) matching the existing client PDF style.
- `br.name`, `S.logoBase64`, `d.quoteNum`, `fmtDatePDF()` are already available in genClientPDF() scope.
- After the cover page, `doc.addPage()` creates a fresh page where the existing "PAGE 1: QUOTE" continues exactly as before.
- Reset `y = margin` after addPage() so the quote page renders at the top.
- Non-cocina projects skip this block entirely (no regression risk).
  </action>
  <verify>Open the HTML file, create a cocina project with 2+ modules, go to step 4 (PDF), generate the client PDF. Verify:
1. First page is a cover page with dark background, company logo (if set), company name in gold, "COTIZACION DE COCINA" title, project/client/date info, and module count
2. Second page is the existing quote page (price summary)
3. Subsequent pages have module index, despiece, hardware, extras, technical note (all existing Phase 4 sections)
4. Generate a closet PDF and verify it has NO cover page (starts directly with the quote page as before)</verify>
  <done>Cocina client PDF opens with a professional branded cover page. Non-cocina PDFs are unaffected. All existing Phase 4 cocina PDF sections (module index, despiece, hardware summary, extras, technical note) remain intact after the cover page.</done>
</task>

<task type="auto">
  <name>Task 2: Add cover page to genInternalPDF() for cocina</name>
  <files>cotizador-template/cotizador-template.html</files>
  <action>
In genInternalPDF() (starts at line 10053), add a simpler cover page for the internal PDF as well. Find the beginning of the function content rendering (after variable setup) and insert before the first content section, gated by `if (intP.type === 'cocina')`:

```javascript
// === COVER PAGE (cocina internal) ===
if (intP.type === 'cocina') {
    doc.setFontSize(20);
    doc.setFont('helvetica', 'bold');
    doc.text('COTIZACION INTERNA - COCINA', pw / 2, 30, { align: 'center' });
    doc.setFontSize(12);
    doc.setFont('helvetica', 'normal');
    doc.text('Proyecto: ' + (intP.name || ''), pw / 2, 42, { align: 'center' });
    doc.text('Cliente: ' + (intP.client || ''), pw / 2, 50, { align: 'center' });
    doc.text('Fecha: ' + new Date().toLocaleDateString('es-MX'), pw / 2, 58, { align: 'center' });
    doc.text('Modulos: ' + intP.modules.length, pw / 2, 66, { align: 'center' });
    doc.addPage();
}
```

Note: The internal PDF uses a simpler white-background style (no dark theme). Use the `intP` alias (already established in 04-03 as `intP = S.project`). Find the correct variable name by reading the function -- it may be `intP` or direct `S.project` references. Match the existing pattern.

Important: Locate the exact insertion point by finding where intP is assigned and where the first content rendering begins. Insert between them.
  </action>
  <verify>Generate an internal PDF for a cocina project. Verify the first page shows "COTIZACION INTERNA - COCINA" with project/client/date/module count, and the second page starts the cost breakdown. Verify closet internal PDF has no cover page.</verify>
  <done>Both genClientPDF() and genInternalPDF() produce cover pages for cocina projects. Non-cocina PDFs remain unaffected.</done>
</task>

</tasks>

<verification>
- Cocina client PDF: page 1 = cover page (dark, branded), page 2+ = existing content
- Cocina internal PDF: page 1 = cover page (simple), page 2+ = existing content
- Closet/TV/Bano PDFs: no cover page, no changes
- All existing cocina PDF sections (from Phase 4) still render correctly after cover page
</verification>

<success_criteria>
- Cocina PDF has a cover page with company branding, project name, client name, date
- Module index, despiece, hardware summary, extras, and technical note sections are present (Phase 4 work preserved)
- Non-cocina PDFs are completely unaffected
</success_criteria>

<output>
After completion, create `.planning/phases/10-quality-polish/10-02-SUMMARY.md`
</output>
